<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <title>Facilities with Confirmed #COVID19PH Cases</title>

    <meta property='og:description' content='Some #COVID19PH Maps. Badly need good data. Hit me up if you have data that you want mapped or visualized.'>
    <meta property='og:image' content='static/img/main.webp'/>

    <meta name='twitter:description' content='Some #COVID19PH Maps. Badly need good data. Hit me up if you have data that you want mapped or visualized.'>
    <meta name='twitter:image' content='static/img/main.webp'/>

    <link rel='shortcut icon' href='https://bnhr.xyz/assets/img/logos/BNHR-avatar-rd-2.png'>

    <!-- Bootstrap CSS-->
    <link href='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh' crossorigin='anonymous'>

    <!-- jQuery -->
    <!-- <script src='https://code.jquery.com/jquery-3.4.1.slim.min.js' integrity='sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n' crossorigin='anonymous'></script> -->
    <script src='https://code.jquery.com/jquery-3.4.1.min.js' integrity='sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=' crossorigin='anonymous'></script>

    <!-- Popper.js -->
    <script src='https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js' integrity='sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo' crossorigin='anonymous'></script>

    <!-- Bootstrap JS -->
    <script src='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js' integrity='sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6' crossorigin='anonymous'></script>

    <!-- LESS -->
    <script src='//cdnjs.cloudflare.com/ajax/libs/less.js/3.9.0/less.min.js' ></script>

    <!-- Mapbox -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.9.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.9.0/mapbox-gl.css' rel='stylesheet' />
    <!-- <link href='https://www.mapbox.com/base/latest/base.css' rel='stylesheet' /> -->


    <!-- D3 -->
    <script src='https://d3js.org/d3.v4.min.js'></script>

    <link rel='stylesheet' href='static/css/main.css'>
</head>

<body>
    <div class='sidebar'>
        <div class='heading px-2 pt-2'>
            <h6>Facilities with Confirmed Cases <i><span id='asof' class='font-weight-light' style='font-size: 11px'></span></i></h6>
            <!-- <p></p> -->
        </div>
        <div class='heading px-2 pt-1'><h6>Legend</h6></div>
            <p class='font-weight-normal px-2 pt-2 small'>FAC - Number of Facilities<br>CAS - Number of Cases<br>
            <span class='font-weight-normal text-secondary'><span id='forVal'></span> Cases For Validation (no location yet)</span>

        <div class='heading px-2 pt-1'><h6>Filter <span class='small'>(individual facilities on map, not the cluster)</span></h6></div>
        <div class='small p-2'>
        <span class='pr-2'>Cases</span> <input class='mx-1 my-1' id='comp-text' type='text' placeholder='<='><input class='mx-1 my-1' id='num-text' type='text' placeholder='50'>
        <input class='mx-1 my-1' id='filter-btn' class='button' type='submit' value='Filter'>
        <input class='mx-1 my-1' id='clear-btn' class='button quiet' type='submit' value='Clear'>
        </div>
        <div class='heading px-2 pt-1'><h6>Facilities</h6></div>
        <div class='listings small' id='listings'></div>
    </div>
    <div id='map' class='map'></div>
    <script src='static/js/main.js'></script>
    <script>
    $.getJSON('https://services5.arcgis.com/mnYJ21GiFTR97WFg/ArcGIS/rest/services/conf_fac_tracking/FeatureServer/0/?f=json', function(data) {
        document.getElementById('asof').innerHTML = `Data as of ${new Date(data.editingInfo.lastEditDate)}`;
    });

    $.getJSON('https://services5.arcgis.com/mnYJ21GiFTR97WFg/ArcGIS/rest/services/conf_fac_tracking/FeatureServer/0/query?where=facility=%27For%20validation%27&outFields=*&f=pgeojson', function(data) {
        document.getElementById('forVal').innerHTML = `${data.features[0].properties.count_}`
    });

    </script>
</body>
</html>
